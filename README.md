# 星痕共鸣 DPS 统计工具

一个基于 Electron 的第三方 DPS 统计工具，用于《星痕共鸣》游戏的实时伤害统计和分析。

## 功能特点

- 🔥 **实时 DPS 监控** - 实时显示当前每秒伤害输出
- 📊 **详细伤害统计** - 包括普通伤害、暴击伤害、幸运伤害等详细分类
- 📈 **历史数据追踪** - 记录峰值 DPS 和平均 DPS
- 👥 **多玩家支持** - 支持团队作战时多个玩家的数据统计
- 🎯 **暴击率分析** - 自动计算暴击率和各类伤害占比
- 💻 **原生客户端** - 基于 Electron 的桌面应用，无需浏览器

## 系统要求

- Windows 10/11 (推荐)
- 管理员权限 (用于网络包捕获)

## 安装与使用

### 从源码运行

1. **克隆项目**
   ```bash
   git clone <repository-url>
   cd StarResonanceDPS
   ```

2. **安装依赖**
   ```bash
   npm install
   ```

3. **以管理员权限启动**
   ```bash
   # Windows (以管理员身份运行命令提示符)
   npm start
   ```

### 构建可执行文件

```bash
# 构建当前平台的可执行文件
npm run build

# 仅打包不构建安装程序
npm run pack

# 构建分发版本
npm run dist
```

## 使用说明

### 第一次使用

1. **启动应用** - 确保以管理员权限运行
2. **选择网络设备** - 点击"选择网络设备"按钮，选择游戏网络流量经过的网络适配器
3. **开始抓包** - 在设备选择窗口中确认选择，自动开始数据包捕获
4. **启动游戏** - 正常启动《星痕共鸣》游戏进行战斗
5. **查看统计** - 应用将自动显示实时 DPS 和详细伤害统计

### 界面说明

#### 控制面板
- **选择网络设备** - 选择用于数据包捕获的网络适配器
- **开始/停止抓包** - 控制数据包捕获的开始和停止
- **清除统计** - 重置所有统计数据

#### 数据展示
- **概览卡片** - 显示实时 DPS、峰值 DPS、平均 DPS 和总伤害
- **详细表格** - 显示每个玩家的详细伤害统计
- **实时日志** - 显示应用运行状态和重要事件

## 技术原理

本工具通过以下方式工作：

1. **网络包捕获** - 使用 `cap` 库捕获本地网络流量
2. **协议解析** - 使用 `protobufjs` 解析游戏的 Protocol Buffers 数据包
3. **数据提取** - 从游戏数据包中提取伤害信息、玩家 UID 等
4. **实时计算** - 实时计算 DPS、统计各类伤害数据
5. **界面展示** - 通过 Electron 提供现代化的用户界面

## 注意事项

### 安全性
- ✅ 本工具仅读取网络数据包，不修改游戏文件或发送任何数据
- ✅ 所有数据处理完全在本地进行，无网络上传
- ✅ 开源代码，可自行审查安全性

### 使用限制
- ⚠️ 需要管理员权限才能进行网络包捕获
- ⚠️ 可能被某些杀毒软件误报，请添加白名单

### 故障排除

**无法启动应用**
- 确保以管理员权限运行
- 检查是否安装了所有依赖

**无法捕获数据**
- 确认选择了正确的网络设备
- 检查游戏是否正在运行
- 尝试切换不同的网络设备

**数据显示异常**
- 重启应用程序
- 清除统计数据后重新开始

## 开发

### 项目结构

```
StarResonanceDPS/
├── main.js              # Electron 主进程
├── algo/
│   └── pb.js            # Protocol Buffers 解析
├── src/
│   ├── index.html       # 主界面
│   ├── device-selector.html  # 设备选择界面
│   ├── styles.css       # 样式文件
│   └── renderer.js      # 渲染进程脚本
├── assets/              # 图标和资源文件
└── package.json         # 项目配置
```

### 开发模式

```bash
# 开发模式启动 (开启开发者工具)
npm run dev
```

### 依赖说明

- **electron** - 跨平台桌面应用框架
- **cap** - 网络包捕获库
- **winston** - 日志记录库
- **protobufjs** - Protocol Buffers 解析库

## 免责声明

本工具仅供学习和研究使用。请遵守游戏服务条款，理性使用第三方工具。开发者不承担因使用本工具而产生的任何风险和后果。

## 致谢

- 感谢 [Dimole](https://github.com/dmlgzs) 的原始服务器版本

---

**如有问题或建议，欢迎提交 Issue 或 Pull Request！**